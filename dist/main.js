!function(){"use strict";!function(){class e{constructor(e,t){this.obj=e,this.obj.style.display=t,this.clearList=this.clearList.bind(this),this.toggleHide=this.toggleHide.bind(this)}toggleHide(){"none"===this.obj.style.display?this.obj.style.display="block":this.obj.style.display="none"}appendChild(e){this.obj.appendChild(e)}clearList(){for(;this.obj.firstChild;)this.obj.removeChild(this.obj.firstChild)}}class t{constructor(e,t,s){this.obj=e,this.obj.innerHTML=`${t}`,this.obj.setAttribute("class",s),this.obj.style.display="inline",this.handleClick=this.handleClick.bind(this),this.obj.addEventListener("click",this.handleClick)}greyOut(){this.obj.removeEventListener("click",this.handleClick),this.obj.setAttribute("class","greyedOut")}setActive(){this.obj.addEventListener("click",this.handleClick),this.obj.setAttribute("class","normal")}handleClick(){new e(document.getElementById("issues_list"),"block"),this.greyOut(),myChart.style.display="none",document.querySelectorAll("path").forEach((e=>e.style.fill="#f9f9f9"))}}const s=new e(document.getElementById("issues_list"),"block");let i=document.getElementById("myChart"),n=new Chart(i,{type:"bar"});n.globalCompositeOperation="destination-over",i.style.display="none";let a=function(e){return e<0?"#F75B5B":0===e?"#5d5c61":1===e||1===e?"#B3E5A2":e>1?"#689D55":void 0};class o{constructor(e){this.ele=e,this.ele.style.fontFamily="sans-serif",this.ele.innerHTML="<span class='close' id='close1'>X</span><br><p>Thank you for visiting this page! This is a chart showing the status of LGBTQ+ rights throughout the US.\n        My goal is to bring awareness to the challenges (and triumphs) queer people have achieved, and will continue to achieve...\n        to facilitate open discussions and set the groundwork for further action. All data comes from the HRC.\n        </p>\n        \n        <p><b><u>Instructions</b></u>:</p>\n        \n        <p>A list of 11 issues is on the right. Click on any issue to see how states score on that particular issue.\n        States are color-coded according to their score:\n        <ul>\n            <li>Red: <0</li>\n            <li>Grey: 0 (no data on that issue in that state)</li>\n            <li>Light Green: 1-2</li>\n            <li>Dark Green: >2</li>\n        </ul>\n        </p>\n        \n        <p>To see a state's scores on all issues, click on that state. The issues will pop up in a bar chart on the right.\n        The bar charts use the same color-coding system (no bar will appear if the score is 0, i.e. if there is no info\n            in that state on that issue).\n        \n        Click \"Clear Selection\" to clear and start over at any point.\n        </p>\n        \n        <p>Please visit my links at the top-right to see more about me!<br>\n            ~ Joe\n        </p>\n        \n        <span class='close' id='close2'>Continue to Map</span>",this.handleClick=this.handleClick.bind(this),[...new Set(document.getElementsByClassName("close"))].forEach((e=>e.addEventListener("click",this.handleClick)))}handleClick(){this.ele.setAttribute("class","hidden")}}document.addEventListener("DOMContentLoaded",(()=>{new class{constructor(e){this.ele=e,this.ele.innerHTML="<h1>LGBTQ+ Rights Across the US</h1><br><br><br><span>No Pride For Some of Us Without Liberation For All of Us</span>",this.ele.style.width="auto",this.ele.style.height="100px",this.ele.style.padding="0 0 30 0",this.ele.style.textAlign="center",this.ele.style.fontSize="26";let t=document.createElement("div");t.setAttribute("id","instructions"),t.innerHTML="i",t.addEventListener("click",(()=>{document.getElementById("info").removeAttribute("class","hidden")})),t.style.cssFloat="right",this.ele.appendChild(t);let s=document.createElement("div");s.setAttribute("id","github"),s.innerHTML='<a href="https://github.com/jprandazzo" target="_blank"><img src="https://aa-lgbtq-rights-map.s3.us-east-2.amazonaws.com/images/github-mark.svg"></a>',s.style.cssFloat="right",this.ele.appendChild(s);let i=document.createElement("div");i.setAttribute("id","linkedin"),i.innerHTML='<a href="https://linkedin.com/in/jprandazzo" target="_blank"><img src="https://aa-lgbtq-rights-map.s3.us-east-2.amazonaws.com/images/LI2.png"></a>',i.style.cssFloat="right",this.ele.appendChild(i)}}(document.getElementById("title")),new t(document.getElementById("back_button"),"Clear Selection","greyedOut"),new e(document.getElementById("issues_list"),"block"),new o(document.getElementById("info")),d3.xml("https://aa-lgbtq-rights-map.s3.us-east-2.amazonaws.com/images/us.svg").then((e=>{d3.select("#us_map").node().append(e.documentElement),d3.selectAll("path").on("click",(()=>{s.obj.style.display="none",i.style.display="block";let e=d3.event.target.id;new t(document.getElementById("back_button"),"Clear Selection","greyedOut").setActive(),async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"https://hrc-lgbtq-2020.herokuapp.com/api";const s=await fetch(t,{method:"POST",body:JSON.stringify({query:"query state ($id: String!) {\n    state (id: $id) {\n        id\n        name\n        region\n        district\n        score {\n            kind\n            description\n        }\n        issues {\n            name\n            kind\n            policy\n            value\n        }\n    }\n}",variables:{id:`${e}`}})});if(!s.ok)throw new Error("Network response was not ok");return await s.json()}(e).then((e=>{let t=e.data.state.name,s=(e.data.state.score.description,e.data.state.score.kind,e.data.state.issues.map(((e,t)=>({x:t,y:e.value,policy:e.policy}))));n.destroy(),Chart.defaults.font.size=16,n=new Chart(i,{type:"bar",data:{labels:e.data.state.issues.map((e=>e.name)),datasets:[{data:s,borderWidth:1,backgroundColor:s.map((e=>a(e.y)))}]},options:{maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Score on each issue for state of ${t}`},tooltip:{displayColors:!1,callbacks:{label:(e,t)=>`Policy: ${e.raw.policy}`}}},scales:{y:{beginAtZero:!0}}}})}))}))}))})),async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://hrc-lgbtq-2020.herokuapp.com/api";const t=await fetch(e,{method:"POST",body:JSON.stringify({query:"query issues ($after: String, $before: String, $first: Int, $last: Int) {\n    issues (after: $after, before: $before, first: $first, last: $last) {\n        pageInfo {\n            hasPreviousPage\n            hasNextPage\n            startCursor\n            endCursor\n        }\n        edges {\n            node {\n                id\n                name\n                states {\n                    id\n                    name\n                    policy\n                    value\n                }\n            }\n            cursor\n        }\n    }\n}",variables:{}})});if(!t.ok)throw new Error("Network response was not ok");return await t.json()}().then((e=>{e.data.issues.edges.forEach((e=>{let s=document.createElement("li");s.setAttribute("id",`${e.node.id}`);let i=document.createTextNode(e.node.name);s.appendChild(i),s.addEventListener("click",(s=>{e.node.states.forEach((e=>{let s=document.querySelector(`#${e.id}`);var i;s.setAttribute("data-value",`${e.value}`),s.setAttribute("data-policy",`${e.policy}`),s.style.fill=(i=e.value)<0?"#F75B5B":0===i?"#989898":1===i||1===i?"#B3E5A2":i>1?"#689D55":void 0,new t(document.getElementById("back_button"),"Clear Selection","greyedOut").setActive()}))})),issues_list.appendChild(s)}))})).catch((e=>{console.error("There has been a problem with your fetch operation: ",e)}))}()}();
//# sourceMappingURL=main.js.map